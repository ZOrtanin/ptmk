# ptmk
Employee Directory CLI Application

## Описание
Консольное приложение для управления справочником сотрудников с поддержкой следующих функций:
- Создание таблицы в базе данных.
- Добавление записей о сотрудниках.
- Вывод всех записей с сортировкой по ФИО.
- Автоматическое заполнение базы данными (1,000,000 записей).
- Поиск по критерию: мужской пол и фамилия на "F".
- Оптимизация запросов к базе данных.

---

## Требования
- **Язык программирования**: Python 3.13.2 
- **База данных**: SQLite.
- **Библиотеки**:
  - `Faker` (для генерации тестовых данных).
  - Установить зависимости:

    ```bash
    pip install -r requirements.txt
    ```

---

## Установка
1. Клонируйте репозиторий:
   ```bash
   git clone [ссылка_на_репозиторий]
   cd employee-directory
   ```
2. Создание виртуального окружения и активация (Linux):
   ```bash
   python3 -m venv venv
   source venv/bin/activate
   ```

3. Установите зависимости:
	```bash 
	pip install -r requirements.txt
	```

```bash

	Package           Version
	----------------- -------
	aiosqlite         0.21.0
	Faker             37.12.0
	iniconfig         2.3.0
	packaging         25.0
	pip               25.3
	pluggy            1.6.0
	psycopg2-binary   2.9.11
	Pygments          2.19.2
	pytest            8.4.2
	SQLAlchemy        2.0.44
	typing_extensions 4.15.0
	tzdata            2025.2

```


## Использование

### Приложение запускается из командной строки с параметрами:
```bash 

	Copypython main.py [режим_работы] [аргументы]

```


Режимы работы
Режим,Описание,Пример запуска


Примеры
1. Создание таблицы
bash Copypython main.py 1

Создаёт таблицу employees с полями: full_name, birth_date, gender.

2. Добавление записи
bash Copypython main.py 2 "Ivanov Petr Sergeevich" 2009-07-12 Male

Создаёт объект Employee с указанными данными.
Преобразует ФИО в транслит (если нужно).
Сохраняет запись в базу.

3. Вывод всех записей
bash Copypython main.py 3

Выводит все записи, отсортированные по ФИО, с указанием возраста.

4. Автоматическое заполнение
bash Copypython main.py 4

Генерирует 1,000,000 записей с равномерным распределением пола и начальных букв ФИО.
Добавляет 100 записей с фамилией на "F" и мужским полом.

5. Поиск по критерию
bash Copypython main.py 5

Выводит записи с мужским полом и фамилией на "F".
Замеряет и выводит время выполнения запроса.

6. Оптимизация
bash Copypython main.py 6

Оптимизирует базу данных (например, добавляет индексы).
Повторяет замер времени выполнения запроса из пункта 5.


Структура проекта
 Copyemployee-directory/
├── main.py          # Основной файл приложения
├── employee.py      # Класс Employee с методами
├── database.py      # Логика работы с базой данных
├── config.py        # Конфигурация подключения к базе
├── requirements.txt # Зависимости
└── README.md        # Документация

Класс Employee

Методы:

save_to_db(): Сохраняет объект в базу.
calculate_age(): Рассчитывает возраст сотрудника.
batch_save(employees): Пакетированное сохранение массива объектов.




Оптимизация

Действия:

Добавление индексов на поля gender и full_name.
Оптимизация SQL-запросов.


Результаты:

Время выполнения запроса до оптимизации: [X] мс.
Время выполнения запроса после оптимизации: [Y] мс.




Отчёт

Результаты замеров времени выполнения до и после оптимизации прилагаются в письме на office@ptmk.ru.
Тема письма: [ФИО] Результаты тестового задания.



### Оптимизация базы данных
проверка идет на таблице с 1000000 строк в среднем


SQLite(сырой):
-------------
0.12389 сек
0.09725 сек
0.09435 сек
0.09361 сек
0.09648 сек
0.09269 сек
0.09738 сек
0.10204 сек
0.0938 сек
0.09452 сек
-------------
0,98601 сек


SQLite(оптимизированный):
-------------
0,39944
0,05408
0,05157
0,05148
0,05311
0,04905
0,05122
0,06275
0,04955
0,04887
-------------
0,87112


PostgresSQL(сырой):
-------------
0,09961
0,07551
0,09235
0,08661
0,0895 
0,07288
0,0821 
0,06836
0,0722 
0,07473
-------------
0,81385

PostgresSQL(оптимизированный):
-------------
0,16039
0,06209
0,0594
0,05867
0,05807
0,08272
0,07133
0,06533
0,06319
0,06175
-------------
0,74294